"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[93569],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var n=a(67294);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var s=n.createContext({}),m=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=m(e.components);return n.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,r=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=m(a),u=l,h=c["".concat(s,".").concat(u)]||c[u]||d[u]||r;return a?n.createElement(h,i(i({ref:t},p),{},{components:a})):n.createElement(h,i({ref:t},p))}));function h(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=a.length,i=new Array(r);i[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[c]="string"==typeof e?e:l,i[1]=o;for(var m=2;m<r;m++)i[m]=a[m];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},85162:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(67294),l=a(86010);const r={tabItem:"tabItem_Ymn6"};function i(e){let{children:t,hidden:a,className:i}=e;return n.createElement("div",{role:"tabpanel",className:(0,l.Z)(r.tabItem,i),hidden:a},t)}},74866:(e,t,a)=>{a.d(t,{Z:()=>v});var n=a(87462),l=a(67294),r=a(86010),i=a(12466),o=a(16550),s=a(91980),m=a(67392),p=a(50012);function c(e){return function(e){return l.Children.map(e,(e=>{if(!e||(0,l.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:a,attributes:n,default:l}}=e;return{value:t,label:a,attributes:n,default:l}}))}function d(e){const{values:t,children:a}=e;return(0,l.useMemo)((()=>{const e=t??c(a);return function(e){const t=(0,m.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function u(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:a}=e;const n=(0,o.k6)(),r=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,s._X)(r),(0,l.useCallback)((e=>{if(!r)return;const t=new URLSearchParams(n.location.search);t.set(r,e),n.replace({...n.location,search:t.toString()})}),[r,n])]}function k(e){const{defaultValue:t,queryString:a=!1,groupId:n}=e,r=d(e),[i,o]=(0,l.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!u({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=a.find((e=>e.default))??a[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:r}))),[s,m]=h({queryString:a,groupId:n}),[c,k]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,r]=(0,p.Nk)(a);return[n,(0,l.useCallback)((e=>{a&&r.set(e)}),[a,r])]}({groupId:n}),N=(()=>{const e=s??c;return u({value:e,tabValues:r})?e:null})();(0,l.useLayoutEffect)((()=>{N&&o(N)}),[N]);return{selectedValue:i,selectValue:(0,l.useCallback)((e=>{if(!u({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);o(e),m(e),k(e)}),[m,k,r]),tabValues:r}}var N=a(72389);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function f(e){let{className:t,block:a,selectedValue:o,selectValue:s,tabValues:m}=e;const p=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.o5)(),d=e=>{const t=e.currentTarget,a=p.indexOf(t),n=m[a].value;n!==o&&(c(t),s(n))},u=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const a=p.indexOf(e.currentTarget)+1;t=p[a]??p[0];break}case"ArrowLeft":{const a=p.indexOf(e.currentTarget)-1;t=p[a]??p[p.length-1];break}}t?.focus()};return l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":a},t)},m.map((e=>{let{value:t,label:a,attributes:i}=e;return l.createElement("li",(0,n.Z)({role:"tab",tabIndex:o===t?0:-1,"aria-selected":o===t,key:t,ref:e=>p.push(e),onKeyDown:u,onClick:d},i,{className:(0,r.Z)("tabs__item",g.tabItem,i?.className,{"tabs__item--active":o===t})}),a??t)})))}function b(e){let{lazy:t,children:a,selectedValue:n}=e;const r=(Array.isArray(a)?a:[a]).filter(Boolean);if(t){const e=r.find((e=>e.props.value===n));return e?(0,l.cloneElement)(e,{className:"margin-top--md"}):null}return l.createElement("div",{className:"margin-top--md"},r.map(((e,t)=>(0,l.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function y(e){const t=k(e);return l.createElement("div",{className:(0,r.Z)("tabs-container",g.tabList)},l.createElement(f,(0,n.Z)({},e,t)),l.createElement(b,(0,n.Z)({},e,t)))}function v(e){const t=(0,N.Z)();return l.createElement(y,(0,n.Z)({key:String(t)},e))}},80911:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>m,toc:()=>c});var n=a(87462),l=(a(67294),a(3905)),r=a(74866),i=a(85162);const o={id:"schema-manage",title:"Manage schema",sidebar_label:"Manage schema",original_id:"schema-manage"},s=void 0,m={unversionedId:"schema-manage",id:"version-2.7.0/schema-manage",title:"Manage schema",description:"This guide demonstrates the ways to manage schemas:",source:"@site/versioned_docs/version-2.7.0/schema-manage.md",sourceDirName:".",slug:"/schema-manage",permalink:"/docs/2.7.0/schema-manage",draft:!1,editUrl:"https://github.com/apache/pulsar-site/edit/main/versioned_docs/version-2.7.0/schema-manage.md",tags:[],version:"2.7.0",frontMatter:{id:"schema-manage",title:"Manage schema",sidebar_label:"Manage schema",original_id:"schema-manage"},sidebar:"version-2.7.0/docsSidebar",previous:{title:"Schema evolution and compatibility",permalink:"/docs/2.7.0/schema-evolution-compatibility"},next:{title:"Overview",permalink:"/docs/2.7.0/functions-overview"}},p={},c=[{value:"Schema AutoUpdate",id:"schema-autoupdate",level:2},{value:"AutoUpdate for producer",id:"autoupdate-for-producer",level:3},{value:"AutoUpdate for consumer",id:"autoupdate-for-consumer",level:3},{value:"Manage AutoUpdate strategy",id:"manage-autoupdate-strategy",level:3},{value:"Enable AutoUpdate",id:"enable-autoupdate",level:4},{value:"Disable AutoUpdate",id:"disable-autoupdate",level:4},{value:"Adjust compatibility",id:"adjust-compatibility",level:4},{value:"Schema validation",id:"schema-validation",level:3},{value:"Enable schema validation",id:"enable-schema-validation",level:4},{value:"Disable schema validation",id:"disable-schema-validation",level:4},{value:"Schema manual management",id:"schema-manual-management",level:2},{value:"Upload a schema",id:"upload-a-schema",level:3},{value:"Get a schema (latest)",id:"get-a-schema-latest",level:3},{value:"Get a schema (specific)",id:"get-a-schema-specific",level:3},{value:"Extract a schema",id:"extract-a-schema",level:3},{value:"Delete a schema",id:"delete-a-schema",level:3},{value:"Custom schema storage",id:"custom-schema-storage",level:2},{value:"Implement",id:"implement",level:3},{value:"SchemaStorage interface",id:"schemastorage-interface",level:4},{value:"SchemaStorageFactory interface",id:"schemastoragefactory-interface",level:4},{value:"Deploy",id:"deploy",level:3}],d={toc:c},u="wrapper";function h(e){let{components:t,...o}=e;return(0,l.kt)(u,(0,n.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"This guide demonstrates the ways to manage schemas:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Automatically"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#schema-autoupdate"},"Schema AutoUpdate")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Manually"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#schema-manual-management"},"Schema manual management"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#custom-schema-storage"},"Custom schema storage")))))),(0,l.kt)("h2",{id:"schema-autoupdate"},"Schema AutoUpdate"),(0,l.kt)("p",null,"If a schema passes the schema compatibility check, Pulsar producer automatically updates this schema to the topic it produces by default."),(0,l.kt)("h3",{id:"autoupdate-for-producer"},"AutoUpdate for producer"),(0,l.kt)("p",null,"For a producer, the ",(0,l.kt)("inlineCode",{parentName:"p"},"AutoUpdate")," happens in the following cases:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"topic doesn\u2019t have a schema"),", Pulsar registers a schema automatically.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"topic has a schema"),":"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"producer doesn\u2019t carry a schema"),":")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If ",(0,l.kt)("inlineCode",{parentName:"p"},"isSchemaValidationEnforced")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," is ",(0,l.kt)("strong",{parentName:"p"},"disabled")," in the namespace to which the topic belongs, the producer is allowed to connect to the topic and produce data.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If ",(0,l.kt)("inlineCode",{parentName:"p"},"isSchemaValidationEnforced")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," is ",(0,l.kt)("strong",{parentName:"p"},"enabled")," in the namespace to which the topic belongs, the producer is rejected and disconnected.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"producer carries a schema"),":"))),(0,l.kt)("p",{parentName:"li"},"A broker performs the compatibility check based on the configured compatibility check strategy of the namespace to which the topic belongs."),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the schema is registered, a producer is connected to a broker.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the schema is not registered:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If ",(0,l.kt)("inlineCode",{parentName:"p"},"isAllowAutoUpdateSchema")," sets to ",(0,l.kt)("strong",{parentName:"p"},"false"),", the producer is rejected to connect to a broker.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If ",(0,l.kt)("inlineCode",{parentName:"p"},"isAllowAutoUpdateSchema")," sets to ",(0,l.kt)("strong",{parentName:"p"},"true"),":"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the schema passes the compatibility check, then the broker registers a new schema automatically for the topic and the producer is connected.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the schema does not pass the compatibility check, then the broker does not register a schema and the producer is rejected to connect to a broker."))))))))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"AutoUpdate Producer",src:a(42529).Z,width:"1278",height:"1228"})),(0,l.kt)("h3",{id:"autoupdate-for-consumer"},"AutoUpdate for consumer"),(0,l.kt)("p",null,"For a consumer, the ",(0,l.kt)("inlineCode",{parentName:"p"},"AutoUpdate")," happens in the following cases:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"consumer connects to a topic without a schema")," (which means the consumer receiving raw bytes), the consumer can connect to the topic successfully without doing any compatibility check.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"consumer connects to a topic with a schema"),"."),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a topic does not have all of them (a schema/data/a local consumer and a local producer):"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If ",(0,l.kt)("inlineCode",{parentName:"p"},"isAllowAutoUpdateSchema")," sets to ",(0,l.kt)("strong",{parentName:"p"},"true"),", then the consumer registers a schema and it is connected to a broker.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If ",(0,l.kt)("inlineCode",{parentName:"p"},"isAllowAutoUpdateSchema")," sets to ",(0,l.kt)("strong",{parentName:"p"},"false"),", then the consumer is rejected to connect to a broker.")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a topic has one of them (a schema/data/a local consumer and a local producer), then the schema compatibility check is performed."),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the schema passes the compatibility check, then the consumer is connected to the broker.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the schema does not pass the compatibility check, then the consumer is rejected to connect to the broker."))))))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"AutoUpdate Consumer",src:a(14175).Z,width:"1404",height:"1298"})),(0,l.kt)("h3",{id:"manage-autoupdate-strategy"},"Manage AutoUpdate strategy"),(0,l.kt)("p",null,"You can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command to manage the ",(0,l.kt)("inlineCode",{parentName:"p"},"AutoUpdate")," strategy as below:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#enable-autoupdate"},"Enable AutoUpdate"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#disable-autoupdate"},"Disable AutoUpdate"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#adjust-compatibility"},"Adjust compatibility")))),(0,l.kt)("h4",{id:"enable-autoupdate"},"Enable AutoUpdate"),(0,l.kt)("p",null,"To enable ",(0,l.kt)("inlineCode",{parentName:"p"},"AutoUpdate")," on a namespace, you can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\nbin/pulsar-admin namespaces set-is-allow-auto-update-schema --enable tenant/namespace\n\n")),(0,l.kt)("h4",{id:"disable-autoupdate"},"Disable AutoUpdate"),(0,l.kt)("p",null,"To disable ",(0,l.kt)("inlineCode",{parentName:"p"},"AutoUpdate")," on a namespace, you can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\nbin/pulsar-admin namespaces set-is-allow-auto-update-schema --disable tenant/namespace\n\n")),(0,l.kt)("p",null,"Once the ",(0,l.kt)("inlineCode",{parentName:"p"},"AutoUpdate")," is disabled, you can only register a new schema using the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command."),(0,l.kt)("h4",{id:"adjust-compatibility"},"Adjust compatibility"),(0,l.kt)("p",null,"To adjust the schema compatibility level on a namespace, you can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\nbin/pulsar-admin namespaces set-schema-compatibility-strategy --compatibility <compatibility-level> tenant/namespace\n\n")),(0,l.kt)("h3",{id:"schema-validation"},"Schema validation"),(0,l.kt)("p",null,"By default, ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," is ",(0,l.kt)("strong",{parentName:"p"},"disabled")," for producers:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"This means a producer without a schema can produce any kind of messages to a topic with schemas, which may result in producing trash data to the topic.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"This allows non-java language clients that don\u2019t support schema can produce messages to a topic with schemas."))),(0,l.kt)("p",null,"However, if you want a stronger guarantee on the topics with schemas, you can enable ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," across the whole cluster or on a per-namespace basis."),(0,l.kt)("h4",{id:"enable-schema-validation"},"Enable schema validation"),(0,l.kt)("p",null,"To enable ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," on a namespace, you can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\nbin/pulsar-admin namespaces set-schema-validation-enforce --enable tenant/namespace\n\n")),(0,l.kt)("h4",{id:"disable-schema-validation"},"Disable schema validation"),(0,l.kt)("p",null,"To disable ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," on a namespace, you can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\nbin/pulsar-admin namespaces set-schema-validation-enforce --disable tenant/namespace\n\n")),(0,l.kt)("h2",{id:"schema-manual-management"},"Schema manual management"),(0,l.kt)("p",null,"To manage schemas, you can use one of the following methods."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Method"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Admin CLI"),(0,l.kt)("li",null)),(0,l.kt)("td",{parentName:"tr",align:null},"You can use the ",(0,l.kt)("inlineCode",{parentName:"td"},"pulsar-admin")," tool to manage Pulsar schemas, brokers, clusters, sources, sinks, topics, tenants and so on. For more information about how to use the ",(0,l.kt)("inlineCode",{parentName:"td"},"pulsar-admin")," tool, see ",(0,l.kt)("a",{parentName:"td",href:"/docs/2.7.0/reference-pulsar-admin"},"here"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"REST API"),(0,l.kt)("li",null)),(0,l.kt)("td",{parentName:"tr",align:null},"Pulsar exposes schema related management API in Pulsar\u2019s admin RESTful API. You can access the admin RESTful endpoint directly to manage schemas. For more information about how to use the Pulsar REST API, see ",(0,l.kt)("a",{parentName:"td",href:"http://pulsar.apache.org/admin-rest-api/"},"here"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Java Admin API"),(0,l.kt)("li",null)),(0,l.kt)("td",{parentName:"tr",align:null},"Pulsar provides Java admin library.")))),(0,l.kt)("h3",{id:"upload-a-schema"},"Upload a schema"),(0,l.kt)("p",null,"To upload (register) a new schema for a topic, you can use one of the following methods."),(0,l.kt)(r.Z,{defaultValue:"Admin CLI",values:[{label:"Admin CLI",value:"Admin CLI"},{label:"REST API",value:"REST API"},{label:"Java Admin API",value:"Java Admin API"}],mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"Admin CLI",mdxType:"TabItem"},(0,l.kt)("p",null,"Use the ",(0,l.kt)("inlineCode",{parentName:"p"},"upload")," subcommand."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\n$ pulsar-admin schemas upload --filename <schema-definition-file> <topic-name>\n\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"schema-definition-file")," is in JSON format."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "type": "<schema-type>",\n    "schema": "<an-utf8-encoded-string-of-schema-definition-data>",\n    "properties": {} // the properties associated with the schema\n}\n\n')),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"schema-definition-file")," includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"schema")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"primitive")," schema, this field should be blank. "),(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"struct")," schema, this field should be a JSON string of the Avro schema definition. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema.")))),(0,l.kt)("p",null,"Here are examples of the ",(0,l.kt)("inlineCode",{parentName:"p"},"schema-definition-file")," for a JSON schema."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example 1")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "type": "JSON",\n    "schema": "{\\"type\\":\\"record\\",\\"name\\":\\"User\\",\\"namespace\\":\\"com.foo\\",\\"fields\\":[{\\"name\\":\\"file1\\",\\"type\\":[\\"null\\",\\"string\\"],\\"default\\":null},{\\"name\\":\\"file2\\",\\"type\\":\\"string\\",\\"default\\":null},{\\"name\\":\\"file3\\",\\"type\\":[\\"null\\",\\"string\\"],\\"default\\":\\"dfdf\\"}]}",\n    "properties": {}\n}\n\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example 2")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "type": "STRING",\n    "schema": "",\n    "properties": {\n        "key1": "value1"\n    }\n}\n\n'))),(0,l.kt)(i.Z,{value:"REST API",mdxType:"TabItem"},(0,l.kt)("p",null,"Send a ",(0,l.kt)("inlineCode",{parentName:"p"},"POST")," request to this endpoint: ",(0,l.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.7.0&apiversion=v2#operation/uploadSchema"},"POST /admin/v2/schemas/:tenant/:namespace/:topic/schema/uploadSchema")),(0,l.kt)("p",null,"The post payload is in JSON format."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "type": "<schema-type>",\n    "schema": "<an-utf8-encoded-string-of-schema-definition-data>",\n    "properties": {} // the properties associated with the schema\n}\n\n')),(0,l.kt)("p",null,"The post payload includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"schema")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"primitive")," schema, this field should be blank. "),(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"struct")," schema, this field should be a JSON string of the Avro schema definition. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema."))))),(0,l.kt)(i.Z,{value:"Java Admin API",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\nvoid createSchema(String topic, PostSchemaPayload schemaPayload)\n\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"PostSchemaPayload")," includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"schema")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"primitive")," schema, this field should be blank. "),(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"struct")," schema, this field should be a JSON string of the Avro schema definition. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema.")))),(0,l.kt)("p",null,"Here is an example of ",(0,l.kt)("inlineCode",{parentName:"p"},"PostSchemaPayload"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'\nPulsarAdmin admin = \u2026;\n\nPostSchemaPayload payload = new PostSchemaPayload();\npayload.setType("INT8");\npayload.setSchema("");\n\nadmin.createSchema("my-tenant/my-ns/my-topic", payload);\n\n')))),(0,l.kt)("h3",{id:"get-a-schema-latest"},"Get a schema (latest)"),(0,l.kt)("p",null,"To get the latest schema for a topic, you can use one of the following methods."),(0,l.kt)(r.Z,{defaultValue:"Admin CLI",values:[{label:"Admin CLI",value:"Admin CLI"},{label:"REST API",value:"REST API"},{label:"Java Admin API",value:"Java Admin API"}],mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"Admin CLI",mdxType:"TabItem"},(0,l.kt)("p",null,"Use the ",(0,l.kt)("inlineCode",{parentName:"p"},"get")," subcommand."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'\n$ pulsar-admin schemas get <topic-name>\n\n{\n    "version": 0,\n    "type": "String",\n    "timestamp": 0,\n    "data": "string",\n    "properties": {\n        "property1": "string",\n        "property2": "string"\n    }\n}\n\n'))),(0,l.kt)(i.Z,{value:"REST API",mdxType:"TabItem"},(0,l.kt)("p",null,"Send a ",(0,l.kt)("inlineCode",{parentName:"p"},"GET")," request to this endpoint: ",(0,l.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.7.0&apiversion=v2#operation/getSchema"},"GET /admin/v2/schemas/:tenant/:namespace/:topic/schema/getSchema")),(0,l.kt)("p",null,"Here is an example of a response, which is returned in JSON format."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "version": "<the-version-number-of-the-schema>",\n    "type": "<the-schema-type>",\n    "timestamp": "<the-creation-timestamp-of-the-version-of-the-schema>",\n    "data": "<an-utf8-encoded-string-of-schema-definition-data>",\n    "properties": {} // the properties associated with the schema\n}\n\n')),(0,l.kt)("p",null,"The response includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"version")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema version, which is a long number.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"timestamp")),(0,l.kt)("td",{parentName:"tr",align:null},"The timestamp of creating this version of schema.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"data")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"primitive"),(0,l.kt)("li",null,"schema, this field should be blank. "),(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"struct"),(0,l.kt)("li",null,"schema, this field should be a JSON string of the Avro schema definition. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema."))))),(0,l.kt)(i.Z,{value:"Java Admin API",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\nSchemaInfo createSchema(String topic)\n\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaInfo")," includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"name")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema name.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"schema")),(0,l.kt)("td",{parentName:"tr",align:null},"A byte array of the schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"primitive"),(0,l.kt)("li",null,"schema, this byte array should be empty. "),(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"struct"),(0,l.kt)("li",null,"schema, this field should be a JSON string of the Avro schema definition converted to a byte array. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema.")))),(0,l.kt)("p",null,"Here is an example of ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaInfo"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'\nPulsarAdmin admin = \u2026;\n\nSchemaInfo si = admin.getSchema("my-tenant/my-ns/my-topic");\n\n')))),(0,l.kt)("h3",{id:"get-a-schema-specific"},"Get a schema (specific)"),(0,l.kt)("p",null,"To get a specific version of a schema, you can use one of the following methods."),(0,l.kt)(r.Z,{defaultValue:"Admin CLI",values:[{label:"Admin CLI",value:"Admin CLI"},{label:"REST API",value:"REST API"},{label:"Java Admin API",value:"Java Admin API"}],mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"Admin CLI",mdxType:"TabItem"},(0,l.kt)("p",null,"Use the ",(0,l.kt)("inlineCode",{parentName:"p"},"get")," subcommand."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\n$ pulsar-admin schemas get <topic-name> --version=<version>\n\n"))),(0,l.kt)(i.Z,{value:"REST API",mdxType:"TabItem"},(0,l.kt)("p",null,"Send a ",(0,l.kt)("inlineCode",{parentName:"p"},"GET")," request to a schema endpoint: ",(0,l.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.7.0&apiversion=v2#operation/getSchema"},"GET /admin/v2/schemas/:tenant/:namespace/:topic/schema/:version/getSchema")),(0,l.kt)("p",null,"Here is an example of a response, which is returned in JSON format."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "version": "<the-version-number-of-the-schema>",\n    "type": "<the-schema-type>",\n    "timestamp": "<the-creation-timestamp-of-the-version-of-the-schema>",\n    "data": "<an-utf8-encoded-string-of-schema-definition-data>",\n    "properties": {} // the properties associated with the schema\n}\n\n')),(0,l.kt)("p",null,"The response includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"version")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema version, which is a long number.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"timestamp")),(0,l.kt)("td",{parentName:"tr",align:null},"The timestamp of creating this version of schema.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"data")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"primitive"),(0,l.kt)("li",null,"schema, this field should be blank. "),(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"struct"),(0,l.kt)("li",null,"schema, this field should be a JSON string of the Avro schema definition. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema."))))),(0,l.kt)(i.Z,{value:"Java Admin API",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\nSchemaInfo createSchema(String topic, long version)\n\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaInfo")," includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"name")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema name.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"schema")),(0,l.kt)("td",{parentName:"tr",align:null},"A byte array of the schema definition data, which is encoded in UTF 8. ",(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"primitive"),(0,l.kt)("li",null,"schema, this byte array should be empty. "),(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"struct"),(0,l.kt)("li",null,"schema, this field should be a JSON string of the Avro schema definition converted to a byte array. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema.")))),(0,l.kt)("p",null,"Here is an example of ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaInfo"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'\nPulsarAdmin admin = \u2026;\n\nSchemaInfo si = admin.getSchema("my-tenant/my-ns/my-topic", 1L);\n\n')))),(0,l.kt)("h3",{id:"extract-a-schema"},"Extract a schema"),(0,l.kt)("p",null,"To provide a schema via a topic, you can use the following method."),(0,l.kt)(r.Z,{defaultValue:"Admin CLI",values:[{label:"Admin CLI",value:"Admin CLI"}],mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"Admin CLI",mdxType:"TabItem"},(0,l.kt)("p",null,"Use the ",(0,l.kt)("inlineCode",{parentName:"p"},"extract")," subcommand."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\n$ pulsar-admin schemas extract --classname <class-name> --jar <jar-path> --type <type-name>\n\n")))),(0,l.kt)("h3",{id:"delete-a-schema"},"Delete a schema"),(0,l.kt)("p",null,"To delete a schema for a topic, you can use one of the following methods."),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"In any case, the ",(0,l.kt)("strong",{parentName:"p"},"delete")," action deletes ",(0,l.kt)("strong",{parentName:"p"},"all versions")," of a schema registered for a topic.")),(0,l.kt)(r.Z,{defaultValue:"Admin CLI",values:[{label:"Admin CLI",value:"Admin CLI"},{label:"REST API",value:"REST API"},{label:"Java Admin API",value:"Java Admin API"}],mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"Admin CLI",mdxType:"TabItem"},(0,l.kt)("p",null,"Use the ",(0,l.kt)("inlineCode",{parentName:"p"},"delete")," subcommand."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\n$ pulsar-admin schemas delete <topic-name>\n\n"))),(0,l.kt)(i.Z,{value:"REST API",mdxType:"TabItem"},(0,l.kt)("p",null,"Send a ",(0,l.kt)("inlineCode",{parentName:"p"},"DELETE")," request to a schema endpoint: ",(0,l.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.7.0&apiversion=v2#operation/deleteSchema"},"DELETE /admin/v2/schemas/:tenant/:namespace/:topic/schema/deleteSchema")),(0,l.kt)("p",null,"Here is an example of a response, which is returned in JSON format."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "version": "<the-latest-version-number-of-the-schema>",\n}\n\n')),(0,l.kt)("p",null,"The response includes the following field:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"version")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema version, which is a long number."))))),(0,l.kt)(i.Z,{value:"Java Admin API",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\nvoid deleteSchema(String topic)\n\n")),(0,l.kt)("p",null,"Here is an example of deleting a schema."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'\nPulsarAdmin admin = \u2026;\n\nadmin.deleteSchema("my-tenant/my-ns/my-topic");\n\n')))),(0,l.kt)("h2",{id:"custom-schema-storage"},"Custom schema storage"),(0,l.kt)("p",null,"By default, Pulsar stores various data types of schemas in ",(0,l.kt)("a",{parentName:"p",href:"https://bookkeeper.apache.org"},"Apache BookKeeper")," deployed alongside Pulsar."),(0,l.kt)("p",null,"However, you can use another storage system if needed."),(0,l.kt)("h3",{id:"implement"},"Implement"),(0,l.kt)("p",null,"To use a non-default (non-BookKeeper) storage system for Pulsar schemas, you need to implement the following Java interfaces:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#schemastorage-interface"},"SchemaStorage interface"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#schemastoragefactory-interface"},"SchemaStorageFactory interface")))),(0,l.kt)("h4",{id:"schemastorage-interface"},"SchemaStorage interface"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaStorage")," interface has the following methods:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\npublic interface SchemaStorage {\n    // How schemas are updated\n    CompletableFuture<SchemaVersion> put(String key, byte[] value, byte[] hash);\n\n    // How schemas are fetched from storage\n    CompletableFuture<StoredSchema> get(String key, SchemaVersion version);\n\n    // How schemas are deleted\n    CompletableFuture<SchemaVersion> delete(String key);\n\n    // Utility method for converting a schema version byte array to a SchemaVersion object\n    SchemaVersion versionFromBytes(byte[] version);\n\n    // Startup behavior for the schema storage client\n    void start() throws Exception;\n\n    // Shutdown behavior for the schema storage client\n    void close() throws Exception;\n}\n\n")),(0,l.kt)("admonition",{type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"For a complete example of ",(0,l.kt)("strong",{parentName:"p"},"schema storage")," implementation, see ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/apache/pulsar/blob/master/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/schema/BookkeeperSchemaStorage.java"},"BookKeeperSchemaStorage")," class.")),(0,l.kt)("h4",{id:"schemastoragefactory-interface"},"SchemaStorageFactory interface"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaStorageFactory")," interface has the following method:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\npublic interface SchemaStorageFactory {\n    @NotNull\n    SchemaStorage create(PulsarService pulsar) throws Exception;\n}\n\n")),(0,l.kt)("admonition",{type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"For a complete example of ",(0,l.kt)("strong",{parentName:"p"},"schema storage factory")," implementation, see ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/apache/pulsar/blob/master/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/schema/BookkeeperSchemaStorageFactory.java"},"BookKeeperSchemaStorageFactory")," class.")),(0,l.kt)("h3",{id:"deploy"},"Deploy"),(0,l.kt)("p",null,"To use your custom schema storage implementation, perform the following steps."),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Package the implementation in a ",(0,l.kt)("a",{parentName:"p",href:"https://docs.oracle.com/javase/tutorial/deployment/jar/basicsindex.html"},"JAR")," file.")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Add the JAR file to the ",(0,l.kt)("inlineCode",{parentName:"p"},"lib")," folder in your Pulsar binary or source distribution.")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Change the ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaRegistryStorageClassName")," configuration in ",(0,l.kt)("inlineCode",{parentName:"p"},"broker.conf")," to your custom factory class.")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Start Pulsar."))))}h.isMDXComponent=!0},14175:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/schema-consumer-436361129cf2d37ee3764960fb377789.png"},42529:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/schema-producer-2682d94503cecdc1dd96dd54bbca105d.png"}}]);