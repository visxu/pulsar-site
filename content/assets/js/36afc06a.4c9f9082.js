"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[23179],{62615:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>t,default:()=>b,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var r=s(74848),a=s(28453);const o={id:"concepts-broker-load-balancing-types",title:"Types",sidebar_label:"Types"},t=void 0,l={id:"concepts-broker-load-balancing-types",title:"Types",description:"Pulsar provides three types of broker load balancers:",source:"@site/docs/concepts-broker-load-balancing-types.md",sourceDirName:".",slug:"/concepts-broker-load-balancing-types",permalink:"/docs/next/concepts-broker-load-balancing-types",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/pulsar-site/edit/main/docs/concepts-broker-load-balancing-types.md",tags:[],version:"current",frontMatter:{id:"concepts-broker-load-balancing-types",title:"Types",sidebar_label:"Types"},sidebar:"docsSidebar",previous:{title:"Concepts",permalink:"/docs/next/concepts-broker-load-balancing-concepts"},next:{title:"Quick start",permalink:"/docs/next/concepts-broker-load-balancing-quick-start"}},i={},d=[{value:"Side-by-side comparisons",id:"side-by-side-comparisons",level:2},{value:"Related topics",id:"related-topics",level:2}];function c(e){const n={a:"a",h2:"h2",li:"li",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Pulsar provides three types of broker load balancers:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Simple broker load balancer: it existed since Pulsar's inception, but now is deprecated."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#side-by-side-comparisons",children:"Modular broker load balancer"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#side-by-side-comparisons",children:"Extensible broker load balancer"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The modular and extensible broker load balancer implements similar load balance functionalities with different system designs. For example, they both employ a similar approach to distributing data loads among brokers, including:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Dynamic ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-broker-load-balancing-concepts#bundle-assignment",children:"bundle-broker assignment"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Dynamic ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-broker-load-balancing-concepts#bundle-splitting",children:"bundle splitting"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Dynamic ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-broker-load-balancing-concepts#bundle-unloading",children:"bundle unloading (shedding)"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["However, for bundle ownership and load data stores, the modular load balancer uses ZooKeeper, whereas the extensible load balancer uses ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-messaging#system-topic",children:"System topics"})," and ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-clients#tableview",children:"Table views"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"side-by-side-comparisons",children:"Side-by-side comparisons"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Dimension"}),(0,r.jsx)(n.th,{children:"Modular broker load balancer"}),(0,r.jsx)(n.th,{children:"Extensible broker load balancer"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Available version"}),(0,r.jsxs)(n.td,{children:["Pulsar 1.7.0 ",(0,r.jsx)("br",{})," ",(0,r.jsx)("br",{}),"2017"]}),(0,r.jsxs)(n.td,{children:["Pulsar 3.0.0 ",(0,r.jsx)("br",{})," ",(0,r.jsx)("br",{}),"2023"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Load Balance Metadata Store and Replication"}),(0,r.jsxs)(n.td,{children:["Dependent on ZooKeeper for load balance metadata store and replication.",(0,r.jsx)("br",{})," ",(0,r.jsx)("br",{})," - All broker load data and all bundle load data are stored in ZooKeeper and replicated to all brokers via ZooKeeper watchers. ",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"- All bundle ownerships are stored in ZooKeeper as ephemeral locks."]}),(0,r.jsxs)(n.td,{children:["Dependent on system topics and table views for load balance metadata store and replication. ",(0,r.jsx)("br",{})," ",(0,r.jsx)("br",{})," - All broker load data are stored in a non-persistent system topic and replicated to all brokers via table views. ",(0,r.jsx)("br",{})," ",(0,r.jsx)("br",{}),"- Each broker publishes only top k bundles' load data in a non-persistent system topic, and only the leader broker consumes it via a table view. ",(0,r.jsx)("br",{})," ",(0,r.jsx)("br",{})," - Bundle ownerships are stored in a persistent system topic and replicated to all brokers via table views.",(0,r.jsx)("br",{})," ",(0,r.jsx)("br",{})," Note: The absolute size of the replicated load data and the complexity of the replication decreased due to passing the data through memory-only, non-persistent topics."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Load Balance Decision",(0,r.jsx)("br",{}),"(Load Balance leader dependency)"]}),(0,r.jsxs)(n.td,{children:["Single leader broker decides on bundle-broker assignment, bundle splitting, and bundle unloading. ",(0,r.jsx)("br",{})," ",(0,r.jsx)("br",{})," Note: The leader broker requires global load information"]}),(0,r.jsxs)(n.td,{children:["Each broker decides and runs bundle-broker assignment (lookup) and bundle splitting based on the local (replicated) information. ",(0,r.jsx)("br",{}),(0,r.jsx)("br",{})," The leader broker still decides on bundle unloading globally."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Pub/sub reconnection upon bundle unloading"}),(0,r.jsxs)(n.td,{children:["When bundles are unloaded, the topics in the bundles are temporarily closed, and producers and consumers connect to new owner brokers. ",(0,r.jsx)("br",{})," ",(0,r.jsx)("br",{})," - Connecting to the new owner brokers involves redirecting lookup requests via the leader broker."]}),(0,r.jsx)(n.td,{children:"Any broker can respond to the lookup requests to locate the new owner brokers without asking the leader broker. The reconnection does not go through the leader broker."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Observability"}),(0,r.jsxs)(n.td,{children:["You can monitor and analyze load balance with various ",(0,r.jsx)(n.a,{href:"/docs/next/reference-metrics",children:"metrics"})]}),(0,r.jsxs)(n.td,{children:["It adds additional ",(0,r.jsx)(n.a,{href:"/docs/next/reference-metrics",children:"metrics"})," and debug mode. For example: ",(0,r.jsx)("br",{}),(0,r.jsx)("br",{})," - Check the status of load balance decision breakdown and failure. ",(0,r.jsx)("br",{}),(0,r.jsx)("br",{})," - Use the dynamic debug mode configuration to dynamically turn on and off more load balance decision logs."]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"related-topics",children:"Related topics"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["To get a comprehensive understanding and discover the key insights, see ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-broker-load-balancing-overview",children:"Broker load balancing | Overview"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["To discover different usage scenarios, see ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-broker-load-balancing-use-cases",children:"Broker load balancing | Use cases"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["To explore functionalities, see ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-broker-load-balancing-features",children:"Broker load balancing | Features"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["To understand advantages, see ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-broker-load-balancing-benefits",children:"Broker load balancing | Benefits"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["To learn essential fundamentals, see ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-broker-load-balancing-concepts",children:"Broker load balancing | Concepts"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["To get up quickly, see ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-broker-load-balancing-quick-start",children:"Broker load balancing | Quick start"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["To migrate one broker load balancer type to another, see ",(0,r.jsx)(n.a,{href:"/docs/next/concepts-broker-load-balancing-migration",children:"Broker load balancing | Migration"}),"."]}),"\n"]}),"\n"]})]})}function b(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var r=s(96540);const a={},o=r.createContext(a);function t(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);