"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[51345],{15680:(e,a,t)=>{t.d(a,{xA:()=>c,yg:()=>y});var n=t(96540);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?i(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function o(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=n.createContext({}),p=function(e){var a=n.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):l(l({},a),e)),t},c=function(e){var a=p(e.components);return n.createElement(s.Provider,{value:a},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},m=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=p(t),m=r,y=u["".concat(s,".").concat(m)]||u[m]||d[m]||i;return t?n.createElement(y,l(l({ref:a},c),{},{components:t})):n.createElement(y,l({ref:a},c))}));function y(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var i=t.length,l=new Array(i);l[0]=m;var o={};for(var s in a)hasOwnProperty.call(a,s)&&(o[s]=a[s]);o.originalType=e,o[u]="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=t[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,t)}m.displayName="MDXCreateElement"},48675:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var n=t(58168),r=(t(96540),t(15680));const i={id:"client-libraries-java-setup",title:"Set up Java client",sidebar_label:"Set up"},l=void 0,o={unversionedId:"client-libraries-java-setup",id:"version-3.0.x/client-libraries-java-setup",title:"Set up Java client",description:"Install Java client library",source:"@site/versioned_docs/version-3.0.x/client-libraries-java-setup.md",sourceDirName:".",slug:"/client-libraries-java-setup",permalink:"/docs/3.0.x/client-libraries-java-setup",draft:!1,editUrl:"https://github.com/apache/pulsar-site/edit/main/versioned_docs/version-3.0.x/client-libraries-java-setup.md",tags:[],version:"3.0.x",frontMatter:{id:"client-libraries-java-setup",title:"Set up Java client",sidebar_label:"Set up"},sidebar:"docsSidebar",previous:{title:"Java",permalink:"/docs/3.0.x/client-libraries-java"},next:{title:"Initialize",permalink:"/docs/3.0.x/client-libraries-java-initialize"}},s={},p=[{value:"Install Java client library",id:"install-java-client-library",level:2},{value:"Maven",id:"maven",level:3},{value:"Gradle",id:"gradle",level:3},{value:"Connect to Pulsar cluster",id:"connect-to-pulsar-cluster",level:2},{value:"Java client Performance considerations",id:"java-client-performance",level:2},{value:"Increasing the memory limit",id:"increasing-the-memory-limit",level:3},{value:"Enabling optimized Netty direct memory buffer access",id:"enabling-optimized-netty-direct-memory-buffer-access",level:3}],c={toc:p},u="wrapper";function d(e){let{components:a,...t}=e;return(0,r.yg)(u,(0,n.A)({},c,t,{components:a,mdxType:"MDXLayout"}),(0,r.yg)("h2",{id:"install-java-client-library"},"Install Java client library"),(0,r.yg)("p",null,"The latest version of the Pulsar Java client library is available via ",(0,r.yg)("a",{parentName:"p",href:"http://search.maven.org/#artifactdetails%7Corg.apache.pulsar%7Cpulsar-client%7C3.0.7%7Cjar"},"Maven Central"),". To use the latest version, add the ",(0,r.yg)("inlineCode",{parentName:"p"},"pulsar-client")," library to your build configuration."),(0,r.yg)("admonition",{type:"tip"},(0,r.yg)("ul",{parentName:"admonition"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://search.maven.org/artifact/org.apache.pulsar/pulsar-client"},(0,r.yg)("inlineCode",{parentName:"a"},"pulsar-client"))," and ",(0,r.yg)("a",{parentName:"li",href:"https://search.maven.org/artifact/org.apache.pulsar/pulsar-client-admin"},(0,r.yg)("inlineCode",{parentName:"a"},"pulsar-client-admin"))," shade dependencies via ",(0,r.yg)("a",{parentName:"li",href:"https://maven.apache.org/plugins/maven-shade-plugin/"},"maven-shade-plugin")," to avoid conflicts of the underlying dependency packages (such as Netty). If you do not want to manage dependency conflicts manually, you can use them."),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://search.maven.org/artifact/org.apache.pulsar/pulsar-client-original"},(0,r.yg)("inlineCode",{parentName:"a"},"pulsar-client-original"))," and ",(0,r.yg)("a",{parentName:"li",href:"https://search.maven.org/artifact/org.apache.pulsar/pulsar-client-admin-original"},(0,r.yg)("inlineCode",{parentName:"a"},"pulsar-client-admin-original"))," ",(0,r.yg)("strong",{parentName:"li"},"does not")," shade dependencies. If you want to manage dependencies manually, you can use them."))),(0,r.yg)("h3",{id:"maven"},"Maven"),(0,r.yg)("p",null,"If you use Maven, add the following information to the ",(0,r.yg)("inlineCode",{parentName:"p"},"pom.xml")," file."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- in your <properties> block --\x3e\n<pulsar.version>3.0.7</pulsar.version>\n\n\x3c!-- in your <dependencies> block --\x3e\n<dependency>\n  <groupId>org.apache.pulsar</groupId>\n  <artifactId>pulsar-client</artifactId>\n  <version>${pulsar.version}</version>\n</dependency>\n")),(0,r.yg)("h3",{id:"gradle"},"Gradle"),(0,r.yg)("p",null,"If you use Gradle, add the following information to the ",(0,r.yg)("inlineCode",{parentName:"p"},"build.gradle")," file."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-groovy"},"def pulsarVersion = '3.0.7'\n\ndependencies {\n    compile group: 'org.apache.pulsar', name: 'pulsar-client', version: pulsarVersion\n}\n")),(0,r.yg)("h2",{id:"connect-to-pulsar-cluster"},"Connect to Pulsar cluster"),(0,r.yg)("p",null,"To connect to Pulsar using client libraries, you need to specify a ",(0,r.yg)("a",{parentName:"p",href:"/docs/3.0.x/developing-binary-protocol"},"Pulsar protocol")," URL."),(0,r.yg)("p",null,"You can assign Pulsar protocol URLs to specific clusters and use the ",(0,r.yg)("inlineCode",{parentName:"p"},"pulsar")," scheme. The following is an example of ",(0,r.yg)("inlineCode",{parentName:"p"},"localhost")," with the default port ",(0,r.yg)("inlineCode",{parentName:"p"},"6650"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-http"},"pulsar://localhost:6650\n")),(0,r.yg)("p",null,"If you have multiple brokers, separate ",(0,r.yg)("inlineCode",{parentName:"p"},"IP:port")," by commas:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-http"},"pulsar://localhost:6550,localhost:6651,localhost:6652\n")),(0,r.yg)("p",null,"If you use ",(0,r.yg)("a",{parentName:"p",href:"/docs/3.0.x/security-tls-authentication"},"mTLS")," authentication, add ",(0,r.yg)("inlineCode",{parentName:"p"},"+ssl")," in the scheme:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-http"},"pulsar+ssl://pulsar.us-west.example.com:6651\n")),(0,r.yg)("h2",{id:"java-client-performance"},"Java client Performance considerations"),(0,r.yg)("h3",{id:"increasing-the-memory-limit"},"Increasing the memory limit"),(0,r.yg)("p",null,"For high-throughput applications, you can increase the amount of memory with the Java client builder's ",(0,r.yg)("a",{parentName:"p",href:"https://pulsar.apache.org/api/client/4.0.x/org/apache/pulsar/client/api/ClientBuilder.html#memoryLimit(long,org.apache.pulsar.client.api.SizeUnit)"},(0,r.yg)("inlineCode",{parentName:"a"},"memoryLimit")," configuration option"),". The default limit is 64MB which is usually too low for high-throughput applications."),(0,r.yg)("p",null,"By default Java applications have a limit for direct memory allocations. The allocations are limited by the ",(0,r.yg)("inlineCode",{parentName:"p"},"-XX:MaxDirectMemorySize")," JVM option. In many JVM implementations, this defaults to the maximum heap size unless explicitly set. Allocations happen outside of the Java heap."),(0,r.yg)("h3",{id:"enabling-optimized-netty-direct-memory-buffer-access"},"Enabling optimized Netty direct memory buffer access"),(0,r.yg)("p",null,"The Pulsar Java client uses ",(0,r.yg)("a",{parentName:"p",href:"https://netty.io/"},"Netty")," under the hood and uses Netty direct buffers for data transport."),(0,r.yg)("p",null,"Netty has a feature that allows optimized direct memory buffer access. This feature enables Netty to use low level APIs such as ",(0,r.yg)("inlineCode",{parentName:"p"},"sun.misc.Unsafe")," for direct memory operations, which provides faster allocation and deallocation of direct buffers.\nThe faster deallocation can help avoid direct memory exhaustion and ",(0,r.yg)("inlineCode",{parentName:"p"},"java.lang.OutOfMemoryError: Direct buffer memory")," errors. These errors can occur when the Netty memory pool and memory allocator cannot release memory back to the operating system quickly enough."),(0,r.yg)("p",null,"To enable this feature in Java clients since Java 11, you need to add the following JVM options to the application that uses the Java client:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"--add-opens java.base/java.nio=ALL-UNNAMED")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"--add-opens java.base/jdk.internal.misc=ALL-UNNAMED"))),(0,r.yg)("p",null,"In addition, you need to add one of the following JVM options:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"-Dorg.apache.pulsar.shade.io.netty.tryReflectionSetAccessible=true")," for the default shaded Pulsar client"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"-Dio.netty.tryReflectionSetAccessible=true"),' for the unshaded "original" Pulsar client')))}d.isMDXComponent=!0}}]);